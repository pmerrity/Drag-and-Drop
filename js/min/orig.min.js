$(document).ready(function(){var e=e||{};!function(){var t,n,o,a=document.createDocumentFragment();e.setup=function(){n=$("#dropListing"),t=$("#dropzone"),t.bind("dragenter",function(e){n.innerHTML="",e.stopPropagation(),e.preventDefault()},!1),t.bind("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),t.bind("drop",e.handleDrop,!1)},e.uploadProgressXHR=function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total),n=e.target.log.firstChild.nextSibling.firstChild;console.log(n),console.log(e.target.self),console.log(e.target),100>t&&(n.style.width=2*t+"px",n.textContent=t+"%")}},e.loadedXHR=function(e){var t=e.target.log;t.addClass("loaded"),console.log("xhr upload of "+e.target.log.id+" complete")},e.uploadError=function(e){console.log("error: "+e.code)},e.processXHR=function(t,n){var o=new XMLHttpRequest,a=$("#droppedItem_"+n),r=o.upload,d=[document.createElement("div"),document.createElement("p")];d[0].className="progressBar",d[1].textContent="0%",d[0].appendChild(d[1]),a.appendChild(d[0]),r.log=a,r.addEventListener("progress",function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total),n=a.firstChild.nextSibling.firstChild;100>t&&(n.style.width=2*t+"px",n.textContent=t+"%")}},!1),r.addEventListener("load",function(){a.className="loaded",console.log("xhr upload of "+a.id+" complete")},!1),r.addEventListener("error",e.uploadError,!1),o.open("POST","../upload.php"),o.overrideMimeType("text/plain; charset=x-user-defined-binary")},e.handleDrop=function(t){var n=t.dataTransfer,o=n.files,a=o.length;t.stopPropagation(),t.preventDefault();for(var r=0;a>r;r++)if(o[r].size<1048576){var d=o[r],l=(d.name,new FileReader);l.index=r,l.file=d,l.addEventListener("loadend",e.buildImageListItem,!1),l.readAsDataURL(d)}else alert("File is too large, needs to be below 1MB.")},e.buildImageListItem=function(t){o=[document.createElement("li"),document.createElement("a"),document.createElement("img"),document.createElement("p")];var r=t.target.result,d=t.target.index,l=t.target.file,i=new FileReader;o[2].src=r,o[1].append(o[2]),o[0].id="droppedItem_"+d,o[0].className="droppedItem",o[0].append(o[1]),a.apend(o[0]),n.append(a),i.addEventListener("loadend",function(t){e.processXHR(l,d,t.target.result)},!1),i.readAsBinaryString(l)},window.addEventListener("load",e.setup,!1);var r=$(".droppedItem img");r.height()<$(".droppedItem").height()&&r.css({height:"100%",width:"auto"})}()});
